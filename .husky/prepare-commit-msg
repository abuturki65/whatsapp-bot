#!/bin/sh
commit_message=$(cat "$1")

prefix_regex="^(feat|fix|chore|docs|style|refactor|test|perf|ci)"
suffix_regex="\([^)]+\): .+"

if ! echo "$commit_message" | grep -Eq "$prefix_regex$suffix_regex"; then
  printf "You must follow commit message rules! (e.g. feat(auth): add login)\033[0m\n\n"
  exit 1
fi

commit_prefix=$(echo "$commit_message" | grep -oE "$prefix_regex")

case "$commit_prefix" in
  feat)     commit_emoji="âœ¨" ;;
  fix)      commit_emoji="ðŸ›" ;;
  chore)    commit_emoji="ðŸ”§" ;;
  docs)     commit_emoji="ðŸ“" ;;
  style)    commit_emoji="ðŸŽ¨" ;;
  refactor) commit_emoji="â™»ï¸" ;;
  test)     commit_emoji="âœ…" ;;
  perf)     commit_emoji="âš¡" ;;
  ci)       commit_emoji="ðŸ¤–" ;;
  *)        commit_emoji="" ;;
esac

echo "$commit_emoji $commit_message" > "$1"